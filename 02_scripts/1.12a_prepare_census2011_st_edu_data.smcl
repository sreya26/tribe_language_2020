{smcl}
{txt}{sf}{ul off}{.-}
      name:  {res}plog_899
       {txt}log:  {res}/Users/sreyamajumder/Dropbox/sreya_majumder/tribelanguage_2020 sreya/02_scripts/1.12a_prepare_census2011_st_edu_data.smcl
  {txt}log type:  {res}smcl
 {txt}opened on:  {res}16 Nov 2021, 12:35:58
{txt}
{com}. ******************************************************************************************************************************************
. * this file brings back the statecode and castecode variables into the tribe groups list from 2011
. * it then adds the district codes from 2011
. * this is used to merge the data with tribe-level education outcomes from Census 2011
. * the data is then collapsed to the level of a tribal group in a district
. * finally, we collapse our data to Census 1961 regions (regions with consistent boundaries between 1961 and 2013).
. ******************************************************************************************************************************************
. 
. project , uses("../08_temp/st_groups_merged_1961_2011.dta")
{txt}project version2_tribe_language > do-file uses: {res}"08_temp/st_groups_merged_1961_2011.dta" filesig(409275321:2250223){txt}

{com}. project , uses("../08_temp/census2011_st_edu_data.dta")
{txt}project version2_tribe_language > do-file uses: {res}"08_temp/census2011_st_edu_data.dta" filesig(1403772620:44470432){txt}

{com}. project , original("../01_data/census_2011_pca_data/DDW_PCA0000_2011_Indiastatedist.xlsx")
{txt}project version2_tribe_language > do-file uses original: {res}"01_data/census_2011_pca_data/DDW_PCA0000_2011_Indiastatedist.xlsx" filesig(2355967605:1283419){txt}

{com}. project , uses("../03_processed/regions6113_with_dists_2011.dta")
{txt}project version2_tribe_language > do-file uses: {res}"03_processed/regions6113_with_dists_2011.dta" filesig(2253008095:240447){txt}

{com}. 
. project , original("1.A_create_1961_statevar.do")
{txt}project version2_tribe_language > do-file uses original: {res}"02_scripts/1.A_create_1961_statevar.do" filesig(2782419759:1871){txt}

{com}. 
. run "1.A_create_1961_statevar.do"
{txt}
{com}. 
. ******************************************************************************************************
. * 1. Merge back tribe group codes created in step #3 of the overall process
. ******************************************************************************************************
. 
.         use "../08_temp/st_groups_merged_1961_2011", clear
{txt}
{com}.         keep if year == 2011
{txt}(641 observations deleted)

{com}.         
.         keep state_code caste_code castegroup_1961_2011_code castegroup_1961_2011
{txt}
{com}. 
.         tempfile codes
{txt}
{com}.         save `codes'
{txt}{p 0 4 2}
file {bf}
/var/folders/m0/4lyk4gcd0rs88ghc7sdnwc600000gn/T//S_00324.000008{rm}
saved
as .dta format
{p_end}

{com}. 
.         use "../08_temp/census2011_st_edu_data", clear
{txt}
{com}.         gen double dcode_2011 = 201100000 + state_code*1000 + district_code
{txt}
{com}.         format dcode_2011 %9.0f
{txt}
{com}.         order dcode_2011, after(district_code)
{txt}
{com}.         
.         merge m:1 state_code caste_code using `codes', assert(master match)
{res}
{txt}{col 5}Result{col 33}Number of obs
{col 5}{hline 41}
{col 5}Not matched{col 30}{res}           2,481
{txt}{col 9}from master{col 30}{res}           2,481{txt}  (_merge==1)
{col 9}from using{col 30}{res}               0{txt}  (_merge==2)

{col 5}Matched{col 30}{res}          42,216{txt}  (_merge==3)
{col 5}{hline 41}

{com}.         
.         assert caste_code == 500 | caste_code > 505000 if _merge == 1 // All STs or the individual Naga tribes in Nagaland
{txt}
{com}.         drop _merge
{txt}
{com}. 
.         replace castegroup_1961_2011_code = caste_code if caste_code == 500
{txt}(1,845 real changes made)

{com}.         replace castegroup_1961_2011 = "All Scheduled Tribes" if caste_code == 500
{txt}(1,845 real changes made)

{com}.         
.         sort state_code district_code caste_code tru
{txt}
{com}.         
.         tempfile temp
{txt}
{com}.         save `temp'
{txt}{p 0 4 2}
file {bf}
/var/folders/m0/4lyk4gcd0rs88ghc7sdnwc600000gn/T//S_00324.000009{rm}
saved
as .dta format
{p_end}

{com}.         
. 
. ******************************************************************************************************
. * 2. Import overall population numbers from the Census 2011 PCA
. ******************************************************************************************************
. 
.         import excel using "../01_data/census_2011_pca_data/DDW_PCA0000_2011_Indiastatedist.xlsx", firstrow case(lower) clear
{res}{text}(94 vars, 2,028 obs)

{com}. 
.         keep state district level name tru tot_p
{txt}
{com}.         drop if level == "India"
{txt}(3 observations deleted)

{com}. 
.         destring state district, replace
{txt}state: all characters numeric; {res}replaced {txt}as {res}byte
{txt}district: all characters numeric; {res}replaced {txt}as {res}int
{txt}
{com}. 
.         rename state state_code
{res}{txt}
{com}.         rename district district_code
{res}{txt}
{com}.         rename tot_p overallpop_2011
{res}{txt}
{com}. 
.         sort state_code district_code tru
{txt}
{com}.         
.         tempfile censuspops
{txt}
{com}.         save `censuspops'
{txt}{p 0 4 2}
file {bf}
/var/folders/m0/4lyk4gcd0rs88ghc7sdnwc600000gn/T//S_00324.00000a{rm}
saved
as .dta format
{p_end}

{com}. 
.         use `temp', clear
{txt}
{com}.         merge m:1 state_code district_code tru using `censuspops', assert(match using) keep(match) keepusing(overallpop_2011) nogen
{res}
{txt}{col 5}Result{col 33}Number of obs
{col 5}{hline 41}
{col 5}Not matched{col 30}{res}               0
{txt}{col 5}Matched{col 30}{res}          44,697{txt}  
{col 5}{hline 41}

{com}.         * there are a bunch of areas where STs are not delimited; those will be in the using dataset and can be discarded
.         
.         drop if caste_code > 505000 // drop individual Naga tribes in Nagaland
{txt}(636 observations deleted)

{com}. 
.         order dcode_2011 caste_code castegroup_1961_2011_code
{txt}
{com}.         sort dcode_2011 caste_code castegroup_1961_2011_code tru
{txt}
{com}. 
. ******************************************************************************************************
. * 4. Collapse to caste group and consistent region level
. ******************************************************************************************************
.         
.         collapse (sum) total_p-age0to19_f (max) overallpop_2011, by(dcode_2011 state district castegroup_1961_2011_code tru) // collapse to caste groups
{res}{txt}
{com}.         
.         merge m:1 dcode_2011 using "../03_processed/regions6113_with_dists_2011", keepusing(region6113 regionname6113) assert(match using)
{res}
{txt}{col 5}Result{col 33}Number of obs
{col 5}{hline 41}
{col 5}Not matched{col 30}{res}              60
{txt}{col 9}from master{col 30}{res}               0{txt}  (_merge==1)
{col 9}from using{col 30}{res}              60{txt}  (_merge==2)

{col 5}Matched{col 30}{res}          40,566{txt}  (_merge==3)
{col 5}{hline 41}

{com}.         
.         gen stcode_2011 = floor(dcode_2011/1000) - 201100
{txt}
{com}. 
.         create_1961_statevar stcode_2011 , gen(state_1961)
{txt}(40,626 missing values generated)
variable {bf}{res}state_1961{sf}{txt} was {bf}{res}str1{sf}{txt} now {bf}{res}str14{sf}
{txt}(1,911 real changes made)
variable {bf}{res}state_1961{sf}{txt} was {bf}{res}str14{sf}{txt} now {bf}{res}str26{sf}
{txt}(2,793 real changes made)
(1,926 real changes made)
(4,824 real changes made)
(144 real changes made)
(1,536 real changes made)
(408 real changes made)
(759 real changes made)
(2,637 real changes made)
(1,362 real changes made)
(6,300 real changes made)
(3,279 real changes made)
(783 real changes made)
(240 real changes made)
(4,038 real changes made)
(45 real changes made)
(1,089 real changes made)
(90 real changes made)
(2,145 real changes made)
(300 real changes made)
(1,578 real changes made)
(2,274 real changes made)
(78 real changes made)
(54 real changes made)
(10 real changes made)
variable {bf}{res}state_1961{sf}{txt} was {bf}{res}str26{sf}{txt} now {bf}{res}str39{sf}
{txt}(18 real changes made)
(5 real changes made)

{com}.         order state_1961
{txt}
{com}.                 
.         assert inlist(state_1961,"Delhi","Punjab","Pondicherry") if _merge == 2
{txt}
{com}.         * _merge == 2 for Punjab, Delhi and Pondicherry, areas where there are no STs [not a problem]
.         keep if _merge == 3
{txt}(60 observations deleted)

{com}.         drop _merge
{txt}
{com}. 
.         replace state_1961 = "Himachal Pradesh" if state_1961 == "Punjab"
{txt}(0 real changes made)

{com}.         
.         replace overallpop_2011 = 0 if ~(tru == "Total" & castegroup_1961_2011_code == 500) // to enable proper summing over dcode's in the following collapse
{txt}(39,748 real changes made)

{com}. 
.         drop if inlist(stcode_2011,5,9) // drop uttar pradesh and uttarakhand
{txt}(1,578 observations deleted)

{com}.         replace regionname6113 = "Himachal Pradesh" if strpos(regionname6113,"Himachal")
{txt}(33 real changes made)

{com}.          
.         collapse (sum) total_p-age0to19_f overallpop_2011, by(state_1961 region6113 regionname6113 castegroup_1961_2011_code tru)
{res}{txt}
{com}.         
.         tempvar overallpop
{txt}
{com}.         egen double `overallpop' = max(overallpop_2011), by(state_1961 region6113 regionname6113) 
{txt}
{com}.         replace overallpop_2011 = `overallpop'
{txt}(21,007 real changes made)

{com}. 
. ******************************************************************************************************
. * 5. Save dataset
. ******************************************************************************************************
.         
.         sort state_1961 region6113 castegroup_1961_2011_code tru
{txt}
{com}.         order state_1961 regionname6113 castegroup_1961_2011_code tru
{txt}
{com}. 
.         rename (total_p-age0to19_f) =_2011
{res}{txt}
{com}.         compress
  {txt}variable {bf}{res}castegroup_1961_2011_code{sf}{txt} was {bf}{res}long{sf}{txt} now {bf}{res}int{sf}
  {txt}variable {bf}{res}region6113{sf}{txt} was {bf}{res}float{sf}{txt} now {bf}{res}int{sf}
  {txt}variable {bf}{res}total_p_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}total_m_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}total_f_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}illiterate_p_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}illiterate_m_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}illiterate_f_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}literate_p_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}literate_m_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}literate_f_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}litnoed_p_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}litnoed_m_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}litnoed_f_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}belowprimary_p_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}belowprimary_m_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}belowprimary_f_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}primary_p_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}primary_m_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}primary_f_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}middle_p_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}middle_m_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}middle_f_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}matric_p_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}matric_m_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}matric_f_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}intermediate_p_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}intermediate_m_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}intermediate_f_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}nontechdiploma_p_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}int{sf}
  {txt}variable {bf}{res}nontechdiploma_m_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}int{sf}
  {txt}variable {bf}{res}nontechdiploma_f_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}int{sf}
  {txt}variable {bf}{res}techdiploma_p_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}techdiploma_m_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}techdiploma_f_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}int{sf}
  {txt}variable {bf}{res}graduate_p_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}graduate_m_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}graduate_f_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}age0to6_p_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}age0to8_p_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}age0to11_p_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}age0to14_p_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}age0to17_p_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}age0to19_p_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}age0to6_m_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}age0to8_m_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}age0to11_m_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}age0to14_m_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}age0to17_m_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}age0to19_m_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}age0to6_f_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}age0to8_f_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}age0to11_f_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}age0to14_f_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}age0to17_f_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}age0to19_f_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}overallpop_2011{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}__000000{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
{txt}  (5,017,596 bytes saved)

{com}.         
.         save "../08_temp/census_2011_st_education_in_1961_regions", replace
{txt}{p 0 4 2}
file {bf}
../08_temp/census_2011_st_education_in_1961_regions.dta{rm}
saved
{p_end}

{com}. 
.         
. project , creates("../08_temp/census_2011_st_education_in_1961_regions.dta")
{txt}project version2_tribe_language > do-file creates: {res}"08_temp/census_2011_st_education_in_1961_regions.dta" filesig(4180270235:7533979){txt}

{com}. 
{txt}end of do-file
      name:  {res}plog_899
       {txt}log:  {res}/Users/sreyamajumder/Dropbox/sreya_majumder/tribelanguage_2020 sreya/02_scripts/1.12a_prepare_census2011_st_edu_data.smcl
  {txt}log type:  {res}smcl
 {txt}closed on:  {res}16 Nov 2021, 12:36:04
{txt}{.-}
{smcl}
{txt}{sf}{ul off}