{smcl}
{txt}{sf}{ul off}{.-}
      name:  {res}plog_810
       {txt}log:  {res}/Users/sreyamajumder/Dropbox/sreya_majumder/tribelanguage_2020 sreya/02_scripts/1.13_apply_district_tribe_group_codes_to_1961_st_edu_data.smcl
  {txt}log type:  {res}smcl
 {txt}opened on:  {res}16 Nov 2021, 12:36:04
{txt}
{com}. ************************************************************************************************************************
. * this file takes the ST education data for individual tribe levels from Census 1961
. * and gives them district and caste [group] codes 
. ************************************************************************************************************************
. 
. project , uses("../08_temp/census_1961_edu_religion_merged.dta")
{txt}project version2_tribe_language > do-file uses: {res}"08_temp/census_1961_edu_religion_merged.dta" filesig(2521991509:5955810){txt}

{com}. project , uses("../08_temp/census_1961_mothertongue_data_with_dist_tribe_codes.dta")
{txt}project version2_tribe_language > do-file uses: {res}"08_temp/census_1961_mothertongue_data_with_dist_tribe_codes.dta" filesig(3966818505:29465773){txt}

{com}. project , uses("../08_temp/regions6113_with_dists_1961.dta")
{txt}project version2_tribe_language > do-file uses: {res}"08_temp/regions6113_with_dists_1961.dta" filesig(21199044:77396){txt}

{com}. 
. ************************************************************************************************************************
. * 3. make the tribes the same as that in the mothertongue data [we do not give any codes here]
. ************************************************************************************************************************
. 
.         
.         use "../08_temp/census_1961_edu_religion_merged.dta", clear
{txt}
{com}. 
.         drop if strpos(tribe,"aggregate")>0 // gets rid of the tribe groupings in Maharashtra
{txt}(10 observations deleted)

{com}. 
.         drop if inlist(tribe,"keer","korama","nat, navdigar, sapera and kubutar","pulayan","vaghri", "all tribes of n.e.f.a.","all tribes of north-east frontier agency","dafla") 
{txt}(42 observations deleted)

{com}.         * these tribes groups could not be merged between 1961 and 2011 (detailed explanation in 1.03b_merge_1961_2011_tribe_groups.do)
.         
.         
.         tempfile edu_data
{txt}
{com}.         save `edu_data'
{txt}{p 0 4 2}
file {bf}
/var/folders/m0/4lyk4gcd0rs88ghc7sdnwc600000gn/T//S_00324.000008{rm}
saved
as .dta format
{p_end}

{com}. 
. ************************************************************************************************************************
. * 4. give codes for individual tribes and tribe groups matched between census 1961 and census 2011  
. ************************************************************************************************************************
.         
.         use "../08_temp/census_1961_mothertongue_data_with_dist_tribe_codes", clear
{txt}
{com}.         drop if missing(dcode_1961) //these are tribes with zero entries in 1961 and do not feature in the census tables, only in the scheduled tribe list 
{txt}(0 observations deleted)

{com}.         keep dcode_1961 tribe castegroup_1961_2011 castegroup_1961_2011_code
{txt}
{com}. 
.         duplicates drop dcode_1961 tribe, force

{p 0 4}{txt}Duplicates in terms of {res} dcode_1961 tribe{p_end}

{txt}(10,279 observations deleted)

{com}. 
.         merge 1:m dcode_1961 tribe using `edu_data', assert(master match)
{res}
{txt}{col 5}Result{col 33}Number of obs
{col 5}{hline 41}
{col 5}Not matched{col 30}{res}               7
{txt}{col 9}from master{col 30}{res}               7{txt}  (_merge==1)
{col 9}from using{col 30}{res}               0{txt}  (_merge==2)

{col 5}Matched{col 30}{res}           5,643{txt}  (_merge==3)
{col 5}{hline 41}

{com}.         
.         assert inlist(dcode_1961,601330,601331,601419,601420,601423,601424,601425) if _merge == 1 
{txt}
{com}.         * these are seven districts of MH and MP where STs are not found (Akola, Bhandara, Buldhana, Nagpur, Wardha, Damoh, Sagar)
.         
.         drop if _merge == 1
{txt}(7 observations deleted)

{com}.         drop _merge
{txt}
{com}.         
.         replace castegroup_1961_2011_code = 500 if tribe == "all scheduled tribes"
{txt}(168 real changes made)

{com}.         replace castegroup_1961_2011 = tribe if tribe == "all scheduled tribes"
{txt}(0 real changes made)

{com}. 
.         replace castegroup_1961_2011_code = 990 if strpos(tribe,"not known")>0 | tribe == "unclassified"
{txt}(0 real changes made)

{com}.         *replace castegroup_2011 = "generic tribes" if strpos(tribe,"not known")>0 | tribe == "unclassified"
.         replace castegroup_1961_2011 = "unclassified" if strpos(tribe,"not known")>0 | tribe == "unclassified"
{txt}(310 real changes made)

{com}. 
. ************************************************************************************************************************
. * 5. now to aggregate the data to consistent 1961-2013 regions
. ** note: we need to be careful while treating the agg_religions variables since they are unique to dcode_1961, and do not change with castegroups
. ************************************************************************************************************************
. 
.         replace state_1961 = "Himachal Pradesh" if state_1961 == "Punjab" // we'll only be using the part of Punjab that went to Himachal
{txt}(12 real changes made)

{com}.         
.         preserve 
{txt}
{com}.                 keep dcode_1961 area agg_* 
{txt}
{com}.                 duplicates drop 

{p 0 4}{txt}Duplicates in terms of {txt} all variables{p_end}

(5,128 observations deleted)

{com}.                 collapse (sum) agg_* , by(dcode_1961)
{res}{txt}
{com}.                 tempfile aggregate_relg
{txt}
{com}.                 save `aggregate_relg'
{txt}{p 0 4 2}
file {bf}
/var/folders/m0/4lyk4gcd0rs88ghc7sdnwc600000gn/T//S_00324.00000a{rm}
saved
as .dta format
{p_end}

{com}.         restore
{txt}
{com}.         
. 
.         collapse (sum) total_m-indefinite_belief_f, by(dcode_1961 castegroup_1961_2011_code)
{res}{txt}
{com}.         merge m:1 dcode_1961 using `aggregate_relg' , assert(match) nogen 
{res}
{txt}{col 5}Result{col 33}Number of obs
{col 5}{hline 41}
{col 5}Not matched{col 30}{res}               0
{txt}{col 5}Matched{col 30}{res}           3,380{txt}  
{col 5}{hline 41}

{com}.         
.         merge m:1 dcode_1961 using "../08_temp/regions6113_with_dists_1961", ///
>                         keepusing(region6113 regionname6113) assert(match using) keep(match) nogen
{res}
{txt}{col 5}Result{col 33}Number of obs
{col 5}{hline 41}
{col 5}Not matched{col 30}{res}               0
{txt}{col 5}Matched{col 30}{res}           3,380{txt}  
{col 5}{hline 41}

{com}.         * there will be many regions in which STs were not delimited and will thus not merge; we drop those
.         
.         preserve 
{txt}
{com}.                 keep dcode_1961 region6113 agg_* 
{txt}
{com}.                 duplicates drop 

{p 0 4}{txt}Duplicates in terms of {txt} all variables{p_end}

(3,113 observations deleted)

{com}.                 collapse (sum) agg_* , by(region6113)
{res}{txt}
{com}.                 tempfile aggregate_region
{txt}
{com}.                 save `aggregate_region'
{txt}{p 0 4 2}
file {bf}
/var/folders/m0/4lyk4gcd0rs88ghc7sdnwc600000gn/T//S_00324.00000c{rm}
saved
as .dta format
{p_end}

{com}.         restore
{txt}
{com}.         
. 
.         collapse (sum) total_m-indefinite_belief_f, by(region6113 regionname6113 castegroup_1961_2011_code)
{res}{txt}
{com}.         merge m:1 region6113 using `aggregate_region'
{res}
{txt}{col 5}Result{col 33}Number of obs
{col 5}{hline 41}
{col 5}Not matched{col 30}{res}               0
{txt}{col 5}Matched{col 30}{res}           3,012{txt}  (_merge==3)
{col 5}{hline 41}

{com}.         
.         
.         
.         order regionname6113 region6113 castegroup_1961_2011_code
{txt}
{com}. 
.         save "../08_temp/census1961_st_edu_religion_with_dist_tribe_codes", replace
{txt}{p 0 4 2}
file {bf}
../08_temp/census1961_st_edu_religion_with_dist_tribe_codes.dta{rm}
saved
{p_end}

{com}. 
.         
. project , creates("../08_temp/census1961_st_edu_religion_with_dist_tribe_codes.dta")
{txt}project version2_tribe_language > do-file creates: {res}"08_temp/census1961_st_edu_religion_with_dist_tribe_codes.dta" filesig(2141767795:2824088){txt}

{com}. 
{txt}end of do-file
      name:  {res}plog_810
       {txt}log:  {res}/Users/sreyamajumder/Dropbox/sreya_majumder/tribelanguage_2020 sreya/02_scripts/1.13_apply_district_tribe_group_codes_to_1961_st_edu_data.smcl
  {txt}log type:  {res}smcl
 {txt}closed on:  {res}16 Nov 2021, 12:36:05
{txt}{.-}
{smcl}
{txt}{sf}{ul off}