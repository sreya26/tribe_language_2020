{smcl}
{txt}{sf}{ul off}{.-}
      name:  {res}plog_901
       {txt}log:  {res}/Users/sreyamajumder/Dropbox/sreya_majumder/tribelanguage_2020 sreya/02_scripts/1.12b_combine_census2011_agg_edu_religion_files.smcl
  {txt}log type:  {res}smcl
 {txt}opened on:  {res}12 Nov 2021, 15:06:49
{txt}
{com}.         
. *************************************************************************************************************************
. * this file appends the original census 2011 education files for overall pop, SC and ST at the state level
. * i.e. from Tables C-8, C-8 SC and C-8 ST
. * it also imputes corresponding values for Non-SC/STs
. 
. *! version 1.0 created by Sreya Majumder on 11th November 2021
. *************************************************************************************************************************
. project , original("../01_data/census_2011_agg_edu_data/DDW-0000C-08.xlsx")     
{txt}project version2_tribe_language > do-file uses original: {res}"01_data/census_2011_agg_edu_data/DDW-0000C-08.xlsx" filesig(456934195:936373){txt}

{com}. project , original("../01_data/census_2011_agg_edu_data/DDW-0000C-08SC.xlsx")   
{txt}project version2_tribe_language > do-file uses original: {res}"01_data/census_2011_agg_edu_data/DDW-0000C-08SC.xlsx" filesig(1422237062:766261){txt}

{com}. project , original("../01_data/census_2011_agg_edu_data/DDW-0000C-08ST.xlsx")   
{txt}project version2_tribe_language > do-file uses original: {res}"01_data/census_2011_agg_edu_data/DDW-0000C-08ST.xlsx" filesig(3034002856:739425){txt}

{com}. project , original("../01_data/census_2011_st_edu_data/C-9/DDW-0000C-09.xlsx")  
{txt}project version2_tribe_language > do-file uses original: {res}"01_data/census_2011_st_edu_data/C-9/DDW-0000C-09.xlsx" filesig(952601288:4273270){txt}

{com}. 
. 
. clear
{txt}
{com}. 
. local edu_folder "../01_data/census_2011_agg_edu_data"
{txt}
{com}. local edu_files: dir "`edu_folder'" files "DDW-0000C-08*.xlsx"  
{txt}
{com}. 
. 
. *************************************************************************************************************************
. * 1. append the education files
. *************************************************************************************************************************
. 
.         tempfile edu_aggs
{txt}
{com}.         save `edu_aggs' , emptyok replace
{txt}(dataset contains 0 observations)
{p 0 4 2}
(file {bf}
/var/folders/m0/4lyk4gcd0rs88ghc7sdnwc600000gn/T//S_00328.000005{rm}
not found)
{p_end}
{p 0 4 2}
file {bf}
/var/folders/m0/4lyk4gcd0rs88ghc7sdnwc600000gn/T//S_00328.000005{rm}
saved
as .dta format
{p_end}

{com}. 
.         foreach file of local edu_files {c -(}
{txt}  2{com}.                 import excel using "`edu_folder'/`file'", clear cellrange(A8)
{txt}  3{com}.                 keep if inlist(A,"C2308","C2508SC","C2708ST")
{txt}  4{com}.                 drop C
{txt}  5{com}.                 gen caste_group = "All" if A == "C2308"
{txt}  6{com}.                 replace caste_group = "SC" if A == "C2508SC"
{txt}  7{com}.                 replace caste_group = "ST" if A == "C2708ST"
{txt}  8{com}.                 drop A
{txt}  9{com}.                 
.                 tempfile table
{txt} 10{com}.                 save `table', replace
{txt} 11{com}.                 
.                 use `edu_aggs', clear
{txt} 12{com}.                 dis as error "Appending data from file `file' ... "
{txt} 13{com}.                 append using `table'
{txt} 14{com}.                 
.                 save`edu_aggs', replace
{txt} 15{com}.                 {c )-}
{res}{text}(46 vars, 2,784 obs)
(0 observations deleted)
(2,784 missing values generated)
variable {bf}{res}caste_group{sf}{txt} was {bf}{res}str1{sf}{txt} now {bf}{res}str2{sf}
{txt}(2,784 real changes made)
(0 real changes made)
{p 0 4 2}
(file {bf}
/var/folders/m0/4lyk4gcd0rs88ghc7sdnwc600000gn/T//S_00328.000006{rm}
not found)
{p_end}
{p 0 4 2}
file {bf}
/var/folders/m0/4lyk4gcd0rs88ghc7sdnwc600000gn/T//S_00328.000006{rm}
saved
as .dta format
{p_end}
{err}Appending data from file DDW-0000C-08SC.xlsx ... 
{txt}{p 0 4 2}
file {bf}
/var/folders/m0/4lyk4gcd0rs88ghc7sdnwc600000gn/T//S_00328.000005{rm}
saved
as .dta format
{p_end}
{res}{text}(46 vars, 3,132 obs)
(0 observations deleted)
(0 real changes made)
(0 real changes made)
{p 0 4 2}
(file {bf}
/var/folders/m0/4lyk4gcd0rs88ghc7sdnwc600000gn/T//S_00328.000007{rm}
not found)
{p_end}
{p 0 4 2}
file {bf}
/var/folders/m0/4lyk4gcd0rs88ghc7sdnwc600000gn/T//S_00328.000007{rm}
saved
as .dta format
{p_end}
{err}Appending data from file DDW-0000C-08.xlsx ... 
{txt}{p 0 7 2}
(variable
{bf:D} was {bf:str28}, now {bf:str33} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:AJ} was {bf:int}, now {bf:long} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:caste_group} was {bf:str2}, now {bf:str3} to accommodate using data's values)
{p_end}
{p 0 4 2}
file {bf}
/var/folders/m0/4lyk4gcd0rs88ghc7sdnwc600000gn/T//S_00328.000005{rm}
saved
as .dta format
{p_end}
{res}{text}(46 vars, 2,697 obs)
(0 observations deleted)
(2,697 missing values generated)
(0 real changes made)
variable {bf}{res}caste_group{sf}{txt} was {bf}{res}str1{sf}{txt} now {bf}{res}str2{sf}
{txt}(2,697 real changes made)
{p 0 4 2}
(file {bf}
/var/folders/m0/4lyk4gcd0rs88ghc7sdnwc600000gn/T//S_00328.000008{rm}
not found)
{p_end}
{p 0 4 2}
file {bf}
/var/folders/m0/4lyk4gcd0rs88ghc7sdnwc600000gn/T//S_00328.000008{rm}
saved
as .dta format
{p_end}
{err}Appending data from file DDW-0000C-08ST.xlsx ... 
{txt}{p 0 4 2}
file {bf}
/var/folders/m0/4lyk4gcd0rs88ghc7sdnwc600000gn/T//S_00328.000005{rm}
saved
as .dta format
{p_end}

{com}. 
.         rename B state_code
{res}{txt}
{com}.         rename D state
{res}{txt}
{com}.         order caste_group, after(state)
{txt}
{com}.         rename E tru
{res}{txt}
{com}.         rename F age_group
{res}{txt}
{com}.         rename G total_p
{res}{txt}
{com}.         rename H total_m
{res}{txt}
{com}.         rename I total_f
{res}{txt}
{com}.         rename J illiterate_p
{res}{txt}
{com}.         rename K illiterate_m
{res}{txt}
{com}.         rename L illiterate_f
{res}{txt}
{com}.         rename M literate_p
{res}{txt}
{com}.         rename N literate_m
{res}{txt}
{com}.         rename O literate_f
{res}{txt}
{com}.         rename P litnoed_p
{res}{txt}
{com}.         rename Q litnoed_m
{res}{txt}
{com}.         rename R litnoed_f
{res}{txt}
{com}.         rename S belowprimary_p
{res}{txt}
{com}.         rename T belowprimary_m
{res}{txt}
{com}.         rename U belowprimary_f
{res}{txt}
{com}.         rename V primary_p
{res}{txt}
{com}.         rename W primary_m
{res}{txt}
{com}.         rename X primary_f
{res}{txt}
{com}.         rename Y middle_p
{res}{txt}
{com}.         rename Z middle_m
{res}{txt}
{com}.         rename AA middle_f
{res}{txt}
{com}.         rename AB matric_p
{res}{txt}
{com}.         rename AC matric_m
{res}{txt}
{com}.         rename AD matric_f
{res}{txt}
{com}.         rename AE intermediate_p
{res}{txt}
{com}.         rename AF intermediate_m
{res}{txt}
{com}.         rename AG intermediate_f
{res}{txt}
{com}.         rename AH nontechdiploma_p
{res}{txt}
{com}.         rename AI nontechdiploma_m
{res}{txt}
{com}.         rename AJ nontechdiploma_f
{res}{txt}
{com}.         rename AK techdiploma_p
{res}{txt}
{com}.         rename AL techdiploma_m
{res}{txt}
{com}.         rename AM techdiploma_f
{res}{txt}
{com}.         rename AN graduate_p
{res}{txt}
{com}.         rename AO graduate_m
{res}{txt}
{com}.         rename AP graduate_f
{res}{txt}
{com}.         rename AQ unclassified_p
{res}{txt}
{com}.         rename AR unclassified_m
{res}{txt}
{com}.         rename AS unclassified_f
{res}{txt}
{com}. 
.         capture drop AT
{txt}
{com}.          
.         replace state = subinstr(state,"State - ","",1)
{txt}(8,352 real changes made)

{com}.         replace state = regexr(state,"[0-9]+$","")
{txt}(0 real changes made)

{com}.         replace state = trim(state)
{txt}(0 real changes made)

{com}. 
.         replace state = proper(state) if strpos(state,"DELHI") == 0
{txt}(8,439 real changes made)

{com}.         replace state = "NCT of Delhi" if strpos(state,"DELHI")
{txt}(174 real changes made)

{com}.         compress
  {txt}variable {bf}{res}state{sf}{txt} was {bf}{res}str33{sf}{txt} now {bf}{res}str25{sf}
{txt}  (68,904 bytes saved)

{com}. 
. *************************************************************************************************************************
. * 2. create equivalent values for Non-SC/STs
. *************************************************************************************************************************
. 
.         preserve
{txt}
{com}.                 foreach var of varlist total_p - unclassified_f {c -(}
{txt}  2{com}.                         replace `var' = -`var' if inlist(caste_group,"SC","ST")
{txt}  3{com}.                 {c )-}
{txt}(5,475 real changes made)
(5,472 real changes made)
(5,465 real changes made)
(5,412 real changes made)
(5,384 real changes made)
(5,380 real changes made)
(5,285 real changes made)
(5,279 real changes made)
(5,264 real changes made)
(5,110 real changes made)
(5,052 real changes made)
(5,012 real changes made)
(5,238 real changes made)
(5,204 real changes made)
(5,180 real changes made)
(4,866 real changes made)
(4,841 real changes made)
(4,823 real changes made)
(4,296 real changes made)
(4,286 real changes made)
(4,225 real changes made)
(3,717 real changes made)
(3,706 real changes made)
(3,643 real changes made)
(3,124 real changes made)
(3,104 real changes made)
(3,046 real changes made)
(2,413 real changes made)
(2,313 real changes made)
(1,859 real changes made)
(2,916 real changes made)
(2,872 real changes made)
(2,571 real changes made)
(2,714 real changes made)
(2,709 real changes made)
(2,615 real changes made)
(4,710 real changes made)
(4,498 real changes made)
(4,480 real changes made)

{com}.                                 
.                 collapse (sum) total_p - unclassified_f , by(state_code state tru age_group)
{res}{txt}
{com}.                 gen caste_group = "Non SC/ST"
{txt}
{com}.                 tempfile nonscst
{txt}
{com}.                 save `nonscst'
{txt}{p 0 4 2}
file {bf}
/var/folders/m0/4lyk4gcd0rs88ghc7sdnwc600000gn/T//S_00328.00000a{rm}
saved
as .dta format
{p_end}

{com}.         restore
{txt}
{com}.         
.         append using `nonscst'
{txt}{p 0 7 2}
(variable
{bf:total_p} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:total_m} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:total_f} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:illiterate_p} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:illiterate_m} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:illiterate_f} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:literate_p} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:literate_m} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:literate_f} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:litnoed_p} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:litnoed_m} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:litnoed_f} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:belowprimary_p} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:belowprimary_m} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:belowprimary_f} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:primary_p} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:primary_m} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:primary_f} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:middle_p} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:middle_m} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:middle_f} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:matric_p} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:matric_m} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:matric_f} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:intermediate_p} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:intermediate_m} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:intermediate_f} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:nontechdiploma_p} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:nontechdiploma_m} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:nontechdiploma_f} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:techdiploma_p} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:techdiploma_m} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:techdiploma_f} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:graduate_p} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:graduate_m} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:graduate_f} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:unclassified_p} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:unclassified_m} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:unclassified_f} was {bf:long}, now {bf:double} to accommodate using data's values)
{p_end}
{p 0 7 2}
(variable
{bf:caste_group} was {bf:str3}, now {bf:str9} to accommodate using data's values)
{p_end}

{com}.         
. *************************************************************************************************************************
. * 3. retain the relevant part of the state-level educational attainment data
. * the relevant age groups we need are:
. * (i) 0-6 years [literacy] ; (ii) 0-8 years [primary] ; (iii) 0-11 years [middle] 
. * (iv) 0-14 years [secondary]; (v) 0-17 years [intermediate] ; (vi) 0-19 years [graduate] 
. *************************************************************************************************************************
. 
.         drop if !inlist(age_group,"All ages","0-6","7","8","9","10","11","12","13") & !inlist(age_group,"14","15","16","17","18","19")
{txt}(5,670 observations deleted)

{com}. 
.         gen upper_age = age_group if !inlist(age_group,"All ages","0-6")
{txt}(810 missing values generated)

{com}.         replace upper_age = "6" if age_group == "0-6"
{txt}(405 real changes made)

{com}. 
.         destring upper_age, replace
{txt}upper_age: all characters numeric; {res}replaced {txt}as {res}byte
{txt}(405 missing values generated)
{res}{txt}
{com}. 
.         local upper_ages 6 8 11 14 17 19
{txt}
{com}. 
.         foreach x in p m f {c -(}
{txt}  2{com}.                 foreach y of local upper_ages {c -(}
{txt}  3{com}.                         tempvar age0to`y'_`x'
{txt}  4{com}.                         egen `age0to`y'_`x'' = sum(total_`x') if inrange(upper_age,6,`y'), by(state_code caste_group tru)
{txt}  5{com}.                         egen age0to`y'_`x' = max(`age0to`y'_`x'') , by(state_code caste_group tru)
{txt}  6{com}.                         drop `age0to`y'_`x''
{txt}  7{com}.                 {c )-}       
{txt}  8{com}.         {c )-}
{txt}(5,670 missing values generated)
(4,860 missing values generated)
(3,645 missing values generated)
(2,430 missing values generated)
(1,215 missing values generated)
(405 missing values generated)
(5,670 missing values generated)
(4,860 missing values generated)
(3,645 missing values generated)
(2,430 missing values generated)
(1,215 missing values generated)
(405 missing values generated)
(5,670 missing values generated)
(4,860 missing values generated)
(3,645 missing values generated)
(2,430 missing values generated)
(1,215 missing values generated)
(405 missing values generated)

{com}. 
.         format %16.0fc total_p - unclassified_f age0*
{txt}
{com}.         drop upper_age
{txt}
{com}. 
.         drop if age_group != "All ages"
{txt}(5,670 observations deleted)

{com}.         drop age_group
{txt}
{com}.         
.         sort state_code caste_group tru
{txt}
{com}.         
.         label define TRU 1 "Total" 2 "Rural" 3 "Urban"
{txt}
{com}.         tempvar tru
{txt}
{com}.         encode tru , gen(`tru') label(TRU)
{txt}
{com}. 
.         drop tru
{txt}
{com}.         clonevar tru = `tru'
{txt}
{com}.         order caste_group tru, after(state)
{txt}
{com}.         
.         sort state_code caste_group tru
{txt}
{com}. 
.         compress
  {txt}variable {bf}{res}tru{sf}{txt} was {bf}{res}long{sf}{txt} now {bf}{res}byte{sf}
  {txt}variable {bf}{res}__00000I{sf}{txt} was {bf}{res}long{sf}{txt} now {bf}{res}byte{sf}
  {txt}variable {bf}{res}total_p{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}total_m{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}total_f{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}illiterate_p{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}illiterate_m{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}illiterate_f{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}literate_p{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}literate_m{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}literate_f{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}litnoed_p{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}litnoed_m{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}litnoed_f{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}belowprimary_p{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}belowprimary_m{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}belowprimary_f{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}primary_p{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}primary_m{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}primary_f{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}middle_p{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}middle_m{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}middle_f{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}matric_p{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}matric_m{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}matric_f{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}intermediate_p{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}intermediate_m{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}intermediate_f{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}nontechdiploma_p{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}nontechdiploma_m{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}nontechdiploma_f{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}techdiploma_p{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}techdiploma_m{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}techdiploma_f{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}graduate_p{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}graduate_m{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}graduate_f{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}unclassified_p{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}unclassified_m{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
  {txt}variable {bf}{res}unclassified_f{sf}{txt} was {bf}{res}double{sf}{txt} now {bf}{res}long{sf}
{txt}  (65,610 bytes saved)

{com}. 
.         drop `tru'
{txt}
{com}.         
.         
.         keep if tru == 1
{txt}(270 observations deleted)

{com}.         keep state_code state caste_group *_p
{txt}
{com}.         
.         replace caste_group = subinstr(caste_group, "Non SC/ST", "Gen", .)
{txt}(36 real changes made)

{com}.         
.         reshape wide *_p, i(state_code state) j(caste_group) string
{txt}(j = All Gen SC ST)

Data{col 36}Long{col 43}->{col 48}Wide
{hline 77}
Number of observations     {res}         135   {txt}->   {res}36          
{txt}Number of variables        {res}          22   {txt}->   {res}78          
{txt}j variable (4 values)       {res}caste_group   {txt}->   (dropped)
xij variables:
                                {res}total_p   {txt}->   {res}total_pAll total_pGen ... total_pST
                           illiterate_p   {txt}->   {res}illiterate_pAll illiterate_pGen ... illiterate_pST
                             literate_p   {txt}->   {res}literate_pAll literate_pGen ... literate_pST
                              litnoed_p   {txt}->   {res}litnoed_pAll litnoed_pGen ... litnoed_pST
                         belowprimary_p   {txt}->   {res}belowprimary_pAll belowprimary_pGen ... belowprimary_pST
                              primary_p   {txt}->   {res}primary_pAll primary_pGen ... primary_pST
                               middle_p   {txt}->   {res}middle_pAll middle_pGen ... middle_pST
                               matric_p   {txt}->   {res}matric_pAll matric_pGen ... matric_pST
                         intermediate_p   {txt}->   {res}intermediate_pAll intermediate_pGen ... intermediate_pST
                       nontechdiploma_p   {txt}->   {res}nontechdiploma_pAll nontechdiploma_pGen ... nontechdiploma_pST
                          techdiploma_p   {txt}->   {res}techdiploma_pAll techdiploma_pGen ... techdiploma_pST
                             graduate_p   {txt}->   {res}graduate_pAll graduate_pGen ... graduate_pST
                         unclassified_p   {txt}->   {res}unclassified_pAll unclassified_pGen ... unclassified_pST
                              age0to6_p   {txt}->   {res}age0to6_pAll age0to6_pGen ... age0to6_pST
                              age0to8_p   {txt}->   {res}age0to8_pAll age0to8_pGen ... age0to8_pST
                             age0to11_p   {txt}->   {res}age0to11_pAll age0to11_pGen ... age0to11_pST
                             age0to14_p   {txt}->   {res}age0to14_pAll age0to14_pGen ... age0to14_pST
                             age0to17_p   {txt}->   {res}age0to17_pAll age0to17_pGen ... age0to17_pST
                             age0to19_p   {txt}->   {res}age0to19_pAll age0to19_pGen ... age0to19_pST
{txt}{hline 77}

{com}.         
.         save "../08_temp/census2011_agg_state_edu_data", replace        
{txt}{p 0 4 2}
file {bf}
../08_temp/census2011_agg_state_edu_data.dta{rm}
saved
{p_end}

{com}.         
.         
. *************************************************************************************************************************
. * 1. append the religion - education files 
. *************************************************************************************************************************
. 
.         
.         import excel using "../01_data/census_2011_st_edu_data/C-9/DDW-0000C-09.xlsx", clear cellrange(A8)
{res}{text}(42 vars, 18,147 obs)

{com}.         keep if A == "C2909"
{txt}(3 observations deleted)

{com}.         drop A
{txt}
{com}. 
. 
.         rename B state_code
{res}{txt}
{com}.         rename C tru 
{res}{txt}
{com}.         rename D state
{res}{txt}
{com}.         rename E religion
{res}{txt}
{com}.         rename F age_group
{res}{txt}
{com}.         rename G total_p
{res}{txt}
{com}.         rename H total_m
{res}{txt}
{com}.         rename I total_f
{res}{txt}
{com}.         rename J illiterate_p
{res}{txt}
{com}.         rename K illiterate_m
{res}{txt}
{com}.         rename L illiterate_f
{res}{txt}
{com}.         rename M literate_p
{res}{txt}
{com}.         rename N literate_m
{res}{txt}
{com}.         rename O literate_f
{res}{txt}
{com}.         rename P litnoed_p
{res}{txt}
{com}.         rename Q litnoed_m
{res}{txt}
{com}.         rename R litnoed_f
{res}{txt}
{com}.         rename S belowprimary_p
{res}{txt}
{com}.         rename T belowprimary_m
{res}{txt}
{com}.         rename U belowprimary_f
{res}{txt}
{com}.         rename V primary_p
{res}{txt}
{com}.         rename W primary_m
{res}{txt}
{com}.         rename X primary_f
{res}{txt}
{com}.         rename Y middle_p
{res}{txt}
{com}.         rename Z middle_m
{res}{txt}
{com}.         rename AA middle_f
{res}{txt}
{com}.         rename AB matric_p
{res}{txt}
{com}.         rename AC matric_m
{res}{txt}
{com}.         rename AD matric_f
{res}{txt}
{com}.         rename AE intermediate_p
{res}{txt}
{com}.         rename AF intermediate_m
{res}{txt}
{com}.         rename AG intermediate_f
{res}{txt}
{com}.         rename AH nontechdiploma_p
{res}{txt}
{com}.         rename AI nontechdiploma_m
{res}{txt}
{com}.         rename AJ nontechdiploma_f
{res}{txt}
{com}.         rename AK techdiploma_p
{res}{txt}
{com}.         rename AL techdiploma_m
{res}{txt}
{com}.         rename AM techdiploma_f
{res}{txt}
{com}.         rename AN graduate_p
{res}{txt}
{com}.         rename AO graduate_m
{res}{txt}
{com}.         rename AP graduate_f
{res}{txt}
{com}. 
.         replace state = subinstr(state,"State - ","",1)
{txt}(17,640 real changes made)

{com}.         replace state = regexr(state,"[0-9]+$","")
{txt}(0 real changes made)

{com}.         replace state = trim(state)
{txt}(0 real changes made)

{com}. 
.         replace state = proper(state) if strpos(state,"DELHI") == 0
{txt}(17,640 real changes made)

{com}.         replace state = "NCT of Delhi" if strpos(state,"DELHI")
{txt}(504 real changes made)

{com}.         destring state_code, replace
{txt}state_code: all characters numeric; {res}replaced {txt}as {res}byte
{txt}
{com}.         compress
  {txt}variable {bf}{res}state{sf}{txt} was {bf}{res}str33{sf}{txt} now {bf}{res}str25{sf}
{txt}  (145,152 bytes saved)

{com}.         
. *************************************************************************************************************************
. * 3. retain the relevant part of the state-level educational attainment data
. * the relevant age groups we need are:
. * (i) 0-6 years [literacy] ; (ii) 0-8 years [primary] ; (iii) 0-11 years [middle] 
. * (iv) 0-14 years [secondary]; (v) 0-17 years [intermediate] ; (vi) 0-19 years [graduate] 
. *************************************************************************************************************************
. 
.         
.         drop if !inlist(age_group,"Total","0-6","7","8","9","10","11","12","13") & !inlist(age_group,"14","15","16","17","18","19")
{txt}(5,184 observations deleted)

{com}. 
.         gen upper_age = age_group if !inlist(age_group,"Total","0-6")
{txt}(1,728 missing values generated)

{com}.         replace upper_age = "6" if age_group == "0-6"
{txt}(864 real changes made)

{com}. 
.         destring upper_age, replace
{txt}upper_age: all characters numeric; {res}replaced {txt}as {res}byte
{txt}(864 missing values generated)
{res}{txt}
{com}. 
.         local upper_ages 6 8 11 14 17 19
{txt}
{com}. 
.         foreach x in p m f {c -(}
{txt}  2{com}.                 foreach y of local upper_ages {c -(}
{txt}  3{com}.                         tempvar age0to`y'_`x'
{txt}  4{com}.                         egen `age0to`y'_`x'' = sum(total_`x') if inrange(upper_age,6,`y'), by(state_code religion tru)
{txt}  5{com}.                         egen age0to`y'_`x' = max(`age0to`y'_`x'') , by(state_code religion tru)
{txt}  6{com}.                         drop `age0to`y'_`x''
{txt}  7{com}.                 {c )-}       
{txt}  8{com}.         {c )-}
{txt}(12,096 missing values generated)
(10,368 missing values generated)
(7,776 missing values generated)
(5,184 missing values generated)
(2,592 missing values generated)
(864 missing values generated)
(12,096 missing values generated)
(10,368 missing values generated)
(7,776 missing values generated)
(5,184 missing values generated)
(2,592 missing values generated)
(864 missing values generated)
(12,096 missing values generated)
(10,368 missing values generated)
(7,776 missing values generated)
(5,184 missing values generated)
(2,592 missing values generated)
(864 missing values generated)

{com}.         
.         foreach y in p m f {c -(}
{txt}  2{com}.                 egen matricplus_p_2011_`y' = rowtotal(matric_`y' intermediate_`y' nontechdiploma_`y' techdiploma_`y' graduate_`y')
{txt}  3{com}. 
.         {c )-}
{txt}
{com}. 
.         format %16.0fc total_p - graduate_f age0* matricplus_*
{txt}
{com}.         drop upper_age
{txt}
{com}. 
.         drop if age_group != "Total"
{txt}(12,096 observations deleted)

{com}.         drop age_group
{txt}
{com}.         
.         sort state_code religion tru
{txt}
{com}.         
.         label define TRU 1 "Total" 2 "Rural" 3 "Urban"
{txt}
{com}.         tempvar tru
{txt}
{com}.         encode tru , gen(`tru') label(TRU)
{txt}
{com}. 
.         drop tru
{txt}
{com}.         clonevar tru = `tru'
{txt}
{com}.         order religion tru, after(state)
{txt}
{com}.         
.         sort state_code religion tru
{txt}
{com}. 
.         compress
  {txt}variable {bf}{res}tru{sf}{txt} was {bf}{res}long{sf}{txt} now {bf}{res}byte{sf}
  {txt}variable {bf}{res}__000011{sf}{txt} was {bf}{res}long{sf}{txt} now {bf}{res}byte{sf}
{txt}  (5,184 bytes saved)

{com}. 
.         drop `tru'
{txt}
{com}.         keep if tru == 1
{txt}(576 observations deleted)

{com}.         
.         save "../08_temp/census2011_religion_edu_data", replace 
{txt}{p 0 4 2}
file {bf}
../08_temp/census2011_religion_edu_data.dta{rm}
saved
{p_end}

{com}.         
.         
. project , creates("../08_temp/census2011_agg_state_edu_data.dta")       
{txt}project version2_tribe_language > do-file creates: {res}"08_temp/census2011_agg_state_edu_data.dta" filesig(1828574044:75869){txt}

{com}. project , creates("../08_temp/census2011_religion_edu_data.dta")        
{txt}project version2_tribe_language > do-file creates: {res}"08_temp/census2011_religion_edu_data.dta" filesig(40294045:122751){txt}

{com}. 
. 
.         
. 
{txt}end of do-file
      name:  {res}plog_901
       {txt}log:  {res}/Users/sreyamajumder/Dropbox/sreya_majumder/tribelanguage_2020 sreya/02_scripts/1.12b_combine_census2011_agg_edu_religion_files.smcl
  {txt}log type:  {res}smcl
 {txt}closed on:  {res}12 Nov 2021, 15:07:11
{txt}{.-}
{smcl}
{txt}{sf}{ul off}